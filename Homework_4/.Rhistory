knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(GGally)
library(psych)
library(car)
library(lmtest)
library(MASS)
library(nlme)
library(nnet)
library(faraway)
# Load data
data(fruitfly, package='faraway')
fruitfly
summary(fruitfly)
?fruitfly
# Load data
data(rats, package='faraway')
glimpse(rats)
summary(rats)
# EDA
par(mfrow=c(1, 2))
boxplot(time ~ poison, data=rats)
boxplot(time ~ treat, data=rats)
par(mfrow=c(1, 3))
boxplot(time ~ treat, data=rats[rats$poison == 'I',], main='Poison I')
boxplot(time ~ treat, data=rats[rats$poison == 'II',], main='Poison II')
boxplot(time ~ treat, data=rats[rats$poison == 'III',], main='Poison III')
# Linear model
lmod <- lm(time ~ poison + treat, data=rats)
lmod2 <- step(lmod, direction='backward')
summary(lmod2)
par(mfrow=c(2, 2))
plot(lmod2)
lmod <- lm(time ~ poison:treat, data=rats)
summary(lmod2)
par(mfrow=c(2, 2))
plot(lmod2)
lmod <- lm(log(time) ~ poison:treat, data=rats)
summary(lmod2)
par(mfrow=c(2, 2))
plot(lmod2)
powerTransform(time ~ poison + treat, data=rats)
lmod <- lm(I(time^0.75) ~ poison + treat + poison:treat, data=rats)
lmod2 <- step(lmod, direction='backward')
summary(lmod2)
par(mfrow=c(2, 2))
plot(lmod2)
glmod <- glm(longevity ~ activity, family=Gamme(link=log))
glmod <- glm(longevity ~ activity, family=Gamma(link=log))
glmod <- glm(longevity ~ activity, family=Gamma(link=log), data=fruitfly)
summary(glmod)
glmod2 <- step(glmod, direction='backward')
summary(glmod2)
glmod2 <- step(glmod, direction='backward')
summary(glmod2)
summary(glmod)
summary(glmod2)
summary(glmod)
summary(fruitfly)
glmod <- glm(longevity ~ activity + thorax, family=Gamma(link=log), data=fruitfly)
summary(glmod)
